// Constants
const USER_PROPERTIES = PropertiesService.getScriptProperties();
const BOT_TOKEN = USER_PROPERTIES.getProperty('bot_token');
const WEBHOOK_URL = USER_PROPERTIES.getProperty('WEBHOOK_URL');
const DRIVE_FOLDER_ID = USER_PROPERTIES.getProperty('DRIVE_FOLDER_ID');
const DOC_ID = USER_PROPERTIES.getProperty('DOC_ID');
const SLIDE_ID = USER_PROPERTIES.getProperty('SLIDE_ID');
const ADMIN_ID = USER_PROPERTIES.getProperty('ADMIN');
var ALLOWED_USER_IDS = USER_PROPERTIES.getProperty('ALLOWED_USER_IDS').split`,`.map((x) => +x);
const SPREADSHEET_ID = USER_PROPERTIES.getProperty('SSID');
const GSHEETS = SpreadsheetApp.openById(SPREADSHEET_ID);
const DATA = GSHEETS.getSheetByName('Data');
const USERS = GSHEETS.getSheetByName('Users');
const TEMP = GSHEETS.getSheetByName('Temp');
const OPTIONS = GSHEETS.getSheetByName('Options');
const SUMMARY = GSHEETS.getSheetByName('Summary');
const REQUESTS = GSHEETS.getSheetByName('Requests');
const DISTANCE_RANGE = GSHEETS.getSheetByName('DvR-Day');
const DISTANCE_EFFICIENCY = GSHEETS.getSheetByName('DvE-Day');
const DISTANCE_BATTERY = GSHEETS.getSheetByName('DvB-Day');
const BATTERY = GSHEETS.getSheetByName('Bat-Day');
const TOP_AVG_SPEED = GSHEETS.getSheetByName('TvAS-Day');
const TOP_AVG_SPEED_MONTH = GSHEETS.getSheetByName('TvAS-MON');
const DISTANCE_RANGE_MONTH = GSHEETS.getSheetByName('DvR-Mon');
const DISTANCE_EFFICIENCY_MONTH = GSHEETS.getSheetByName('DvE-Mon');
const DISTANCE_BATTERY_MONTH = GSHEETS.getSheetByName('DvB-Mon');
const BATTERY_MONTH = GSHEETS.getSheetByName('Bat-Mon');
const TELEGRAM_URL = 'https://api.telegram.org/bot' + BOT_TOKEN + '/';
const TELEGRAM_FILE_URL = 'https://api.telegram.org/file/bot' + BOT_TOKEN + '/';
var BATTERY_CAPACITY = OPTIONS.getRange('B2').getValue();
var LOG = USER_PROPERTIES.getProperty('LOG');
var RUN_TIME_DATA = GSHEETS.getSheetByName('Runtime');
var RUN_TIME_COUNT = USER_PROPERTIES.getProperty('RUN_TIME_COUNT');
var RUN_TIME_MSEC = USER_PROPERTIES.getProperty('RUN_TIME_MSEC');
var RUN_DATE_UPDATED = USER_PROPERTIES.getProperty('RUN_DATE_UPDATED');
const TELEGRAM_GROUP_ID = USER_PROPERTIES.getProperty('GROUP_ID');
var GROUP_CHECK = USER_PROPERTIES.getProperty('GROUP_CHECK');
const DRIVE_ID_USER_DATA = USER_PROPERTIES.getProperty('DRIVE_ID_USER_DATA');
